<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hangouts</title>

<!-- Firebase compat SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #0a0f1e;
    color: #e0e6f0;
    font-family: 'Segoe UI', sans-serif;
    min-height: 100vh;
    padding: 24px 16px;
  }
  h1.app-title {
    text-align: center;
    font-size: 1.6rem;
    letter-spacing: 2px;
    color: #7eb8f7;
    margin-bottom: 28px;
    text-transform: uppercase;
  }
  .btn-reset {
    display: block;
    margin: 0 auto 20px auto;
    padding: 10px 28px;
    background: transparent;
    border: 2px solid #e05555;
    color: #e05555;
    border-radius: 10px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    letter-spacing: 1px;
    transition: background 0.2s, color 0.2s;
  }
  .btn-reset:hover { background: #e05555; color: #fff; }
  .sections {
    display: flex;
    gap: 24px;
    max-width: 1100px;
    margin: 0 auto;
    flex-wrap: wrap;
  }
  .section {
    flex: 1;
    min-width: 300px;
    border-radius: 18px;
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }
  .section-luci {
    background: linear-gradient(135deg, #1e0a1a 0%, #2a0f22 100%);
    border: 2px solid #c06090;
    box-shadow: 0 0 30px #c0608033;
  }
  .section-luci .section-title { color: #f0a0c8; text-shadow: 0 0 10px #f0a0c855; }
  .section-luci .block { background: #2e1028; border: 1px solid #a0507888; }
  .section-luci .block-title { color: #f0a0c8; }
  .section-luci input[type=text], .section-luci textarea, .section-luci input[type=time] {
    background: #3a1530; border: 1px solid #c06090; color: #f8d0e8;
  }
  .section-luci input[type=text]::placeholder, .section-luci textarea::placeholder { color: #c090a8; }
  .section-luci .btn-add { background: #c06090; }
  .section-luci .btn-add:hover { background: #e080b0; }
  .section-luci input[type=range] { accent-color: #e080b0; }
  .section-luci .mood-val { color: #f0a0c8; }
  .section-luci .tag-high { background: #8b1a3a; color: #ffb0c8; border-color: #c0406070; }
  .section-luci .tag-med  { background: #7a3060; color: #f0c0e0; border-color: #c06090; }
  .section-luci .tag-low  { background: #3a1550; color: #c0a0e0; border-color: #8060a0; }
  .section-luci .item { background: #3a1535; border-left: 3px solid #c06090; }
  .section-luci .btn-del { color: #f0a0c8; }

  .section-oliver {
    background: linear-gradient(135deg, #0e0e0e 0%, #1a1a1a 100%);
    border: 2px solid #555;
    box-shadow: 0 0 30px #55555533;
  }
  .section-oliver .section-title { color: #e0e0e0; text-shadow: 0 0 10px #ffffff22; }
  .section-oliver .block { background: #111; border: 1px solid #33333388; }
  .section-oliver .block-title { color: #cccccc; }
  .section-oliver input[type=text], .section-oliver textarea, .section-oliver input[type=time] {
    background: #1a1a1a; border: 1px solid #444; color: #e0e0e0;
  }
  .section-oliver input[type=text]::placeholder, .section-oliver textarea::placeholder { color: #666; }
  .section-oliver .btn-add { background: #444; }
  .section-oliver .btn-add:hover { background: #666; }
  .section-oliver input[type=range] { accent-color: #aaa; }
  .section-oliver .mood-val { color: #ccc; }
  .section-oliver .tag-high { background: #2a2a2a; color: #fff; border-color: #666; }
  .section-oliver .tag-med  { background: #222; color: #ccc; border-color: #444; }
  .section-oliver .tag-low  { background: #1a1a1a; color: #888; border-color: #333; }
  .section-oliver .item { background: #1c1c1c; border-left: 3px solid #555; }
  .section-oliver .btn-del { color: #888; }

  .section-title {
    font-size: 1.3rem; font-weight: 700; letter-spacing: 1px;
    text-align: center; padding-bottom: 8px; border-bottom: 1px solid #ffffff22;
  }
  .block { border-radius: 12px; padding: 16px; }
  .block-title {
    font-size: 0.85rem; font-weight: 600; text-transform: uppercase;
    letter-spacing: 1px; margin-bottom: 12px;
  }
  .mood-row { display: flex; align-items: center; gap: 12px; }
  input[type=range] { flex: 1; height: 6px; border-radius: 3px; cursor: pointer; outline: none; border: none; background: transparent; }
  .mood-val { font-size: 1.5rem; font-weight: 700; min-width: 32px; text-align: center; }
  .mood-labels { display: flex; justify-content: space-between; font-size: 0.7rem; opacity: 0.5; margin-top: 4px; }

  .add-row { display: flex; gap: 8px; margin-bottom: 10px; flex-wrap: wrap; }
  input[type=text] { flex: 1; min-width: 120px; padding: 7px 10px; border-radius: 8px; font-size: 0.9rem; outline: none; }
  .tag-select {
    padding: 7px 8px; border-radius: 8px; font-size: 0.8rem; cursor: pointer; outline: none;
    background: #222; color: #ccc; border: 1px solid #444;
  }
  .btn-add {
    padding: 7px 14px; border-radius: 8px; border: none; color: #fff;
    font-size: 0.9rem; cursor: pointer; font-weight: 600; transition: background 0.2s;
  }
  .items-list { display: flex; flex-direction: column; gap: 7px; }
  .item {
    display: flex; align-items: center; gap: 8px;
    padding: 8px 10px; border-radius: 8px; font-size: 0.88rem;
  }
  .item-text { flex: 1; }
  .tag {
    font-size: 0.7rem; font-weight: 700; padding: 2px 8px;
    border-radius: 20px; border: 1px solid; text-transform: uppercase; letter-spacing: 0.5px;
    white-space: nowrap;
  }
  .reaction-btn {
    background: none; border: none; cursor: pointer;
    font-size: 1.1rem; padding: 2px 3px; border-radius: 6px;
    transition: transform 0.15s, opacity 0.15s;
    opacity: 0.35; line-height: 1;
  }
  .reaction-btn:hover { transform: scale(1.3); opacity: 0.7; }
  .reaction-btn.active { opacity: 1; transform: scale(1.2); }

  .btn-del {
    background: none; border: none; cursor: pointer; font-size: 1rem;
    opacity: 0.5; transition: opacity 0.2s; padding: 0 2px;
  }
  .btn-del:hover { opacity: 1; }

  .time-row { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
  .time-label { font-size: 0.85rem; opacity: 0.7; }
  input[type=time] { padding: 7px 10px; border-radius: 8px; font-size: 0.95rem; outline: none; cursor: pointer; }

  textarea {
    width: 100%; min-height: 90px; padding: 10px; border-radius: 10px;
    font-size: 0.9rem; outline: none; resize: vertical; font-family: inherit; line-height: 1.5;
  }

  .sync-dot {
    display: inline-block; width: 8px; height: 8px; border-radius: 50%;
    background: #4caf50; margin-right: 6px; animation: pulse 2s infinite;
  }
  .sync-status { text-align: center; font-size: 0.75rem; opacity: 0.6; margin-bottom: 8px; }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }

  @media(max-width:700px) { .sections { flex-direction: column; } }
</style>
</head>
<body>

<h1 class="app-title">Hangouts</h1>
<button class="btn-reset" id="resetBtn">üóëÔ∏è Vymazat v≈°e a zaƒç√≠t znovu</button>
<div class="sync-status"><span class="sync-dot"></span>P≈ôipojeno ‚Äì zmƒõny se synchronizuj√≠ v re√°ln√©m ƒçase</div>

<div class="sections">
  <!-- LUCINKA -->
  <div class="section section-luci">
    <div class="section-title">üå∏ Lucinka-bobinka</div>
    <div class="block">
      <div class="block-title">Mood today</div>
      <div class="mood-row">
        <input type="range" min="1" max="10" value="5" id="luci-mood">
        <div class="mood-val" id="luci-mood-val">5</div>
      </div>
      <div class="mood-labels"><span>1</span><span>5</span><span>10</span></div>
    </div>
    <div class="block">
      <div class="block-title">üí° N√°pady / aktivity</div>
      <div class="add-row">
        <input type="text" id="luci-idea-input" placeholder="Nov√Ω n√°pad...">
        <select class="tag-select" id="luci-idea-tag">
          <option value="high">üî¥ High</option>
          <option value="med" selected>üü° Medium</option>
          <option value="low">üü¢ Low</option>
        </select>
        <button class="btn-add" id="luci-idea-btn">+</button>
      </div>
      <div class="items-list" id="luci-ideas-list"></div>
    </div>
    <div class="block">
      <div class="block-title">üö´ Na co se dnes nec√≠t√≠m</div>
      <div class="add-row">
        <input type="text" id="luci-nope-input" placeholder="P≈ôidat...">
        <select class="tag-select" id="luci-nope-tag">
          <option value="high">üî¥ High</option>
          <option value="med" selected>üü° Medium</option>
          <option value="low">üü¢ Low</option>
        </select>
        <button class="btn-add" id="luci-nope-btn">+</button>
      </div>
      <div class="items-list" id="luci-nopes-list"></div>
    </div>
    <div class="block">
      <div class="block-title">‚è∞ M√°m ƒças</div>
      <div class="time-row">
        <span class="time-label">Od</span>
        <input type="time" id="luci-time-from">
        <span class="time-label">Do</span>
        <input type="time" id="luci-time-to">
      </div>
    </div>
    <div class="block">
      <div class="block-title">üìù Pozn√°mky</div>
      <textarea id="luci-notes" placeholder="Napi≈° cokoliv..."></textarea>
    </div>
  </div>

  <!-- OLIVER -->
  <div class="section section-oliver">
    <div class="section-title">üñ§ Oliver-zlobiver</div>
    <div class="block">
      <div class="block-title">Mood today</div>
      <div class="mood-row">
        <input type="range" min="1" max="10" value="5" id="oliver-mood">
        <div class="mood-val" id="oliver-mood-val">5</div>
      </div>
      <div class="mood-labels"><span>1</span><span>5</span><span>10</span></div>
    </div>
    <div class="block">
      <div class="block-title">üí° N√°pady / aktivity</div>
      <div class="add-row">
        <input type="text" id="oliver-idea-input" placeholder="Nov√Ω n√°pad...">
        <select class="tag-select" id="oliver-idea-tag">
          <option value="high">üî¥ High</option>
          <option value="med" selected>üü° Medium</option>
          <option value="low">üü¢ Low</option>
        </select>
        <button class="btn-add" id="oliver-idea-btn">+</button>
      </div>
      <div class="items-list" id="oliver-ideas-list"></div>
    </div>
    <div class="block">
      <div class="block-title">üö´ Na co se dnes nec√≠t√≠m</div>
      <div class="add-row">
        <input type="text" id="oliver-nope-input" placeholder="P≈ôidat...">
        <select class="tag-select" id="oliver-nope-tag">
          <option value="high">üî¥ High</option>
          <option value="med" selected>üü° Medium</option>
          <option value="low">üü¢ Low</option>
        </select>
        <button class="btn-add" id="oliver-nope-btn">+</button>
      </div>
      <div class="items-list" id="oliver-nopes-list"></div>
    </div>
    <div class="block">
      <div class="block-title">‚è∞ M√°m ƒças</div>
      <div class="time-row">
        <span class="time-label">Od</span>
        <input type="time" id="oliver-time-from">
        <span class="time-label">Do</span>
        <input type="time" id="oliver-time-to">
      </div>
    </div>
    <div class="block">
      <div class="block-title">üìù Pozn√°mky</div>
      <textarea id="oliver-notes" placeholder="Napi≈° cokoliv..."></textarea>
    </div>
  </div>
</div>

<script>
// Firebase init (compat SDK)
const firebaseConfig = {
  apiKey: "AIzaSyBrKgiaDAsMXYcR7jmgTw-A75C8JqbaBV4",
  authDomain: "luci-d6774.firebaseapp.com",
  databaseURL: "https://luci-d6774-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "luci-d6774",
  storageBucket: "luci-d6774.firebasestorage.app",
  messagingSenderId: "322365660885",
  appId: "1:322365660885:web:28460e40861cef0f0c0c5c"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const tagLabel = { high: 'üî¥ High', med: 'üü° Medium', low: 'üü¢ Low' };
let updateTimeout = {};

// Helper to generate unique ID
const uid = () => 'item_' + Date.now() + '_' + Math.random().toString(36).slice(2, 7);

// Render list
function renderList(person, type, items) {
  const el = document.getElementById(`${person}-${type}-list`);
  if (!el) return;
  el.innerHTML = '';
  if (!items) return;
  
  const arr = Object.entries(items).map(([id, item]) => ({id, ...item}));
  arr.forEach(item => {
    const div = document.createElement('div');
    div.className = 'item';
    const reaction = item.reaction || null;
    
    div.innerHTML = `
      <span class="item-text">${item.text}</span>
      <span class="tag tag-${item.tag}">${tagLabel[item.tag]}</span>
      <button class="reaction-btn ${reaction === 'heart' ? 'active' : ''}" 
        data-person="${person}" data-type="${type}" data-id="${item.id}" data-reaction="heart">‚ù§Ô∏è</button>
      <button class="reaction-btn ${reaction === 'broken' ? 'active' : ''}" 
        data-person="${person}" data-type="${type}" data-id="${item.id}" data-reaction="broken">üíî</button>
      <button class="btn-del" data-person="${person}" data-type="${type}" data-id="${item.id}">‚úï</button>
    `;
    el.appendChild(div);
  });
}

// Add item
function addItem(person, type) {
  const isIdea = type === 'ideas';
  const input = document.getElementById(`${person}-${isIdea ? 'idea' : 'nope'}-input`);
  const tagSelect = document.getElementById(`${person}-${isIdea ? 'idea' : 'nope'}-tag`);
  
  const text = input.value.trim();
  if (!text) return;
  
  const id = uid();
  const itemData = {
    text: text,
    tag: tagSelect.value,
    reaction: null
  };
  
  db.ref(`${person}/${type}/${id}`).set(itemData)
    .then(() => {
      input.value = '';
      console.log('Item added!');
    })
    .catch(err => console.error('Error adding item:', err));
}

// Delete item
function deleteItem(person, type, id) {
  db.ref(`${person}/${type}/${id}`).remove()
    .catch(err => console.error('Error deleting:', err));
}

// Set reaction
function setReaction(person, type, id, reaction) {
  db.ref(`${person}/${type}/${id}`).once('value', snap => {
    const current = snap.val()?.reaction;
    const newVal = current === reaction ? null : reaction;
    db.ref(`${person}/${type}/${id}/reaction`).set(newVal);
  });
}

// Event delegation for dynamic buttons
document.addEventListener('click', e => {
  if (e.target.classList.contains('reaction-btn')) {
    const {person, type, id, reaction} = e.target.dataset;
    setReaction(person, type, id, reaction);
  }
  if (e.target.classList.contains('btn-del')) {
    const {person, type, id} = e.target.dataset;
    deleteItem(person, type, id);
  }
});

// Setup for each person
['luci', 'oliver'].forEach(person => {
  // Mood
  const moodSlider = document.getElementById(`${person}-mood`);
  const moodVal = document.getElementById(`${person}-mood-val`);
  
  moodSlider.addEventListener('input', () => {
    moodVal.textContent = moodSlider.value;
    db.ref(`${person}/mood`).set(parseInt(moodSlider.value));
  });
  
  db.ref(`${person}/mood`).on('value', snap => {
    const v = snap.val() || 5;
    if (document.activeElement !== moodSlider) {
      moodSlider.value = v;
      moodVal.textContent = v;
    }
  });
  
  // Lists
  db.ref(`${person}/ideas`).on('value', snap => {
    renderList(person, 'ideas', snap.val());
  });
  
  db.ref(`${person}/nopes`).on('value', snap => {
    renderList(person, 'nopes', snap.val());
  });
  
  // Time
  const timeFrom = document.getElementById(`${person}-time-from`);
  const timeTo = document.getElementById(`${person}-time-to`);
  
  const saveTime = () => {
    db.ref(`${person}/time`).set({
      from: timeFrom.value,
      to: timeTo.value
    });
  };
  
  timeFrom.addEventListener('change', saveTime);
  timeTo.addEventListener('change', saveTime);
  
  db.ref(`${person}/time`).on('value', snap => {
    const t = snap.val() || {};
    if (document.activeElement !== timeFrom) timeFrom.value = t.from || '';
    if (document.activeElement !== timeTo) timeTo.value = t.to || '';
  });
  
  // Notes
  const notes = document.getElementById(`${person}-notes`);
  
  notes.addEventListener('input', () => {
    clearTimeout(updateTimeout[person]);
    updateTimeout[person] = setTimeout(() => {
      db.ref(`${person}/notes`).set(notes.value);
    }, 500);
  });
  
  db.ref(`${person}/notes`).on('value', snap => {
    if (document.activeElement !== notes) {
      notes.value = snap.val() || '';
    }
  });
  
  // Buttons
  document.getElementById(`${person}-idea-btn`).addEventListener('click', () => addItem(person, 'ideas'));
  document.getElementById(`${person}-nope-btn`).addEventListener('click', () => addItem(person, 'nopes'));
  
  // Enter key
  document.getElementById(`${person}-idea-input`).addEventListener('keydown', e => {
    if (e.key === 'Enter') addItem(person, 'ideas');
  });
  document.getElementById(`${person}-nope-input`).addEventListener('keydown', e => {
    if (e.key === 'Enter') addItem(person, 'nopes');
  });
});

// Reset button
document.getElementById('resetBtn').addEventListener('click', () => {
  if (!confirm('Opravdu chce≈° vymazat v≈°echna data? Tato akce je nevratn√°.')) return;
  
  db.ref('luci').remove()
    .then(() => db.ref('oliver').remove())
    .then(() => alert('V≈°e vymaz√°no!'))
    .catch(err => console.error('Error:', err));
});

console.log('Aplikace naƒçtena!');
</script>
</body>
</html>
